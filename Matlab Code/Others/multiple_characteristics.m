clear;
close all;

figure("Name", "Average number of photons over pumping probability");

avgPhotonsX1 = [1126.2166666666667, 1134.56, 1145.3766666666668, 1166.15, 1180.5766666666666, 1216.9333333333334, 1238.8133333333333, 1285.9333333333334, ...
1343.9166666666667, 1464.66, 1592.2933333333333, 1750.65, 2008.8066666666666, 2273.79, 2695.09, ...
3280.653333333333, 4144.663333333333, 5367.776666666667, 7016.13, 9315.393333333333, 12458.876666666667, 16700.046666666665, ...
22547.396666666667, 30537.82, 41285.86, 55178.986666666664, 71518.17666666667, 86699.72666666667, 96082.90666666666, ...
99280.99];

avgPhotonsX10 = [1143.2386666666666, 1151.0126666666667, 1163.727, 1177.389, 1195.9916666666666, 1226.561, 1264.6583333333333, 1310.4396666666667, ...
1375.6346666666666, 1476.3596666666667, 1603.823, 1783.1233333333332, 2036.7726666666667, 2361.001, 2787.941, ...
3398.6053333333334, 4258.921666666667, 5465.366333333333, 7168.708, 9504.670666666667, 12702.520333333334, 17037.028666666665, ...
22981.591333333334, 31102.938666666665, 42081.12233333333, 56347.54833333333, 73066.56933333333, 88513.89733333333, 98109.54566666667, ...
101101.99933333334];

avgPhotonsDiv10 = [1126.56, 1140.43, 1132.8766666666668, 1146.7733333333333, 1179.2233333333334, 1206.1366666666668, 1245.5966666666666, 1293.41, ...
1357.3166666666666, 1463.1866666666667, 1579.0233333333333, 1754.03, 2018.22, 2217.7266666666665, 2440.4766666666665, ...
2836.81, 3443.38, 4627.406666666667, 6469.706666666667, 9015.033333333333, 12266.283333333333, 16491.4, ...
22339.646666666667, 30300.083333333332, 40927.276666666665, 54730.14, 70686.43, 85644.46333333333, 95477.65666666666, ...
99245.07666666666];

pumping = logspace(-4, 0, 30);
hold on;
loglog(pumping, avgPhotonsX1);
loglog(pumping, avgPhotonsX10);
loglog(pumping, avgPhotonsDiv10);
hold off;
title("Average number of photons over pumping probability, with noise = 0.5%");
legend("Parameters: noise = 0.005, \tau_a = 30, \tau_c = 10", ...
    "Parameters: noise = 0.005, \tau_a = 300, \tau_c = 10", ...
    "Parameters: noise = 0.005, \tau_a = 3, \tau_c = 10");
xlabel("Pumping Probability");
ylabel("Average number of photons");
set(gca, 'XScale', 'log', 'YScale', 'log');
grid on;

